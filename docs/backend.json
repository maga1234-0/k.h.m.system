{
  "entities": {
    "Room": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Room",
      "type": "object",
      "description": "Represents a room in the hotel.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the room."
        },
        "roomNumber": {
          "type": "string",
          "description": "The room number."
        },
        "roomType": {
          "type": "string",
          "description": "The type of room (e.g., Single, Double, Suite)."
        },
        "capacity": {
          "type": "number",
          "description": "The maximum occupancy of the room."
        },
        "status": {
          "type": "string",
          "description": "The current status of the room (e.g., Available, Occupied, Maintenance)."
        },
        "pricePerNight": {
          "type": "number",
          "description": "The price per night for the room."
        },
        "amenities": {
          "type": "array",
          "description": "A list of amenities offered in the room.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "roomNumber",
        "roomType",
        "capacity",
        "status",
        "pricePerNight"
      ]
    },
    "Reservation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Reservation",
      "type": "object",
      "description": "Represents a reservation made by a client.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the reservation."
        },
        "clientId": {
          "type": "string",
          "description": "Reference to Client. (Relationship: Client 1:N Reservation)"
        },
        "roomId": {
          "type": "string",
          "description": "Reference to Room. (Relationship: Room 1:N Reservation)"
        },
        "checkInDate": {
          "type": "string",
          "description": "The date the reservation starts.",
          "format": "date-time"
        },
        "checkOutDate": {
          "type": "string",
          "description": "The date the reservation ends.",
          "format": "date-time"
        },
        "numberOfGuests": {
          "type": "number",
          "description": "The number of guests for the reservation."
        },
        "totalAmount": {
          "type": "number",
          "description": "The total amount for the reservation."
        },
        "status": {
          "type": "string",
          "description": "The current status of the reservation (e.g., Confirmed, Cancelled, CheckedIn, CheckedOut)."
        }
      },
      "required": [
        "id",
        "clientId",
        "roomId",
        "checkInDate",
        "checkOutDate",
        "numberOfGuests",
        "totalAmount",
        "status"
      ]
    },
    "Client": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Client",
      "type": "object",
      "description": "Represents a client.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the client."
        },
        "firstName": {
          "type": "string",
          "description": "The first name of the client."
        },
        "lastName": {
          "type": "string",
          "description": "The last name of the client."
        },
        "email": {
          "type": "string",
          "description": "The email address of the client.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "The phone number of the client."
        },
        "address": {
          "type": "string",
          "description": "The address of the client."
        },
        "preferences": {
          "type": "string",
          "description": "Any specific preferences of the client."
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "phoneNumber"
      ]
    },
    "Invoice": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Invoice",
      "type": "object",
      "description": "Represents an invoice for a reservation.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the invoice."
        },
        "reservationId": {
          "type": "string",
          "description": "Reference to Reservation. (Relationship: Reservation 1:1 Invoice)"
        },
        "invoiceDate": {
          "type": "string",
          "description": "The date the invoice was generated.",
          "format": "date-time"
        },
        "dueDate": {
          "type": "string",
          "description": "The date the invoice is due.",
          "format": "date-time"
        },
        "amountDue": {
          "type": "number",
          "description": "The total amount due on the invoice."
        },
        "amountPaid": {
          "type": "number",
          "description": "The amount that has been paid on the invoice."
        },
        "paymentDate": {
          "type": "string",
          "description": "The date the payment was received.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "The current status of the invoice (e.g., Paid, Unpaid, Overdue)."
        }
      },
      "required": [
        "id",
        "reservationId",
        "invoiceDate",
        "dueDate",
        "amountDue"
      ]
    },
    "Staff": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Staff",
      "type": "object",
      "description": "Represents a staff member.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the staff member."
        },
        "firstName": {
          "type": "string",
          "description": "The first name of the staff member."
        },
        "lastName": {
          "type": "string",
          "description": "The last name of the staff member."
        },
        "email": {
          "type": "string",
          "description": "The email address of the staff member.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "The phone number of the staff member."
        },
        "role": {
          "type": "string",
          "description": "The role of the staff member (e.g., Manager, Receptionist)."
        },
        "permissions": {
          "type": "string",
          "description": "The permissions assigned to the staff member."
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "phoneNumber",
        "role"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/rooms/{roomId}",
        "definition": {
          "entityName": "Room",
          "schema": {
            "$ref": "#/backend/entities/Room"
          },
          "description": "Stores room information. The 'roomId' is a unique identifier for each room.",
          "params": [
            {
              "name": "roomId",
              "description": "Unique identifier for the room."
            }
          ]
        }
      },
      {
        "path": "/reservations/{reservationId}",
        "definition": {
          "entityName": "Reservation",
          "schema": {
            "$ref": "#/backend/entities/Reservation"
          },
          "description": "Stores reservation details. The 'reservationId' is a unique identifier for each reservation.",
          "params": [
            {
              "name": "reservationId",
              "description": "Unique identifier for the reservation."
            }
          ]
        }
      },
      {
        "path": "/clients/{clientId}",
        "definition": {
          "entityName": "Client",
          "schema": {
            "$ref": "#/backend/entities/Client"
          },
          "description": "Stores client information. The 'clientId' is a unique identifier for each client.",
          "params": [
            {
              "name": "clientId",
              "description": "Unique identifier for the client."
            }
          ]
        }
      },
      {
        "path": "/invoices/{invoiceId}",
        "definition": {
          "entityName": "Invoice",
          "schema": {
            "$ref": "#/backend/entities/Invoice"
          },
          "description": "Stores invoice details. The 'invoiceId' is a unique identifier for each invoice.",
          "params": [
            {
              "name": "invoiceId",
              "description": "Unique identifier for the invoice."
            }
          ]
        }
      },
      {
        "path": "/staff/{staffId}",
        "definition": {
          "entityName": "Staff",
          "schema": {
            "$ref": "#/backend/entities/Staff"
          },
          "description": "Stores staff member information. The 'staffId' is a unique identifier for each staff member.",
          "params": [
            {
              "name": "staffId",
              "description": "Unique identifier for the staff member."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the core features of the Karatasi Hotelier application, focusing on room management, reservation management, client management, automated billing, and staff management. The design prioritizes Authorization Independence and QAPs (Rules are not Filters). Each entity is stored in its own top-level collection to maintain clarity and simplify security rules.\n\nRooms are stored in the `/rooms` collection. Reservations, Clients, Invoices and Staff are stored in respective collections (`/reservations`, `/clients`, `/invoices`, `/staff`). This structure allows for easy querying and management of each entity type. The Room entity is central to the app, and its collection is named accordingly.\n\nAuthorization Independence:\nAll entities are designed to operate without requiring hierarchical authorization dependencies, eliminating the need for `get()` calls in security rules. For collaborative data or data that depends on the state of another document, relevant authorization information is denormalized. This applies particularly to scenarios where access to reservations or invoices might depend on client or room attributes.\n\nQAPs Support:\nThe structure supports secure `list` operations by ensuring that each collection maintains a consistent security posture. Data segregation by entity type allows for targeted security rules that do not act as filters. This is particularly important for listing rooms, reservations, or clients, where access control must be enforced without exposing unauthorized data."
  }
}