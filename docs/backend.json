{
  "entities": {
    "Room": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Room",
      "type": "object",
      "description": "Represents a room in the hotel.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the room."
        },
        "roomNumber": {
          "type": "string",
          "description": "The room number."
        },
        "roomType": {
          "type": "string",
          "description": "The type of room (e.g., Single, Double, Suite)."
        },
        "availability": {
          "type": "string",
          "description": "The availability status of the room (e.g., Available, Occupied, Maintenance)."
        },
        "price": {
          "type": "number",
          "description": "The price of the room per night."
        },
        "amenities": {
          "type": "array",
          "description": "A list of amenities available in the room.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "roomNumber",
        "roomType",
        "availability",
        "price"
      ]
    },
    "Reservation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Reservation",
      "type": "object",
      "description": "Represents a reservation made by a client.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the reservation."
        },
        "clientId": {
          "type": "string",
          "description": "Reference to Client. (Relationship: Client 1:N Reservation)"
        },
        "roomId": {
          "type": "string",
          "description": "Reference to Room. (Relationship: Room 1:N Reservation)"
        },
        "checkInDate": {
          "type": "string",
          "description": "The check-in date of the reservation.",
          "format": "date-time"
        },
        "checkOutDate": {
          "type": "string",
          "description": "The check-out date of the reservation.",
          "format": "date-time"
        },
        "numberOfGuests": {
          "type": "number",
          "description": "The number of guests for the reservation."
        },
        "totalAmount": {
          "type": "number",
          "description": "The total amount for the reservation."
        },
        "status": {
          "type": "string",
          "description": "The status of the reservation (e.g., Confirmed, Cancelled, CheckedIn, CheckedOut)."
        },
        "notes": {
          "type": "string",
          "description": "Any notes for this reservation."
        }
      },
      "required": [
        "id",
        "clientId",
        "roomId",
        "checkInDate",
        "checkOutDate",
        "numberOfGuests",
        "totalAmount",
        "status"
      ]
    },
    "Client": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Client",
      "type": "object",
      "description": "Represents a client of the hotel.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the client."
        },
        "firstName": {
          "type": "string",
          "description": "The first name of the client."
        },
        "lastName": {
          "type": "string",
          "description": "The last name of the client."
        },
        "email": {
          "type": "string",
          "description": "The email address of the client.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "The phone number of the client."
        },
        "address": {
          "type": "string",
          "description": "The address of the client."
        },
        "preferences": {
          "type": "string",
          "description": "The client's preferences."
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "phoneNumber"
      ]
    },
    "Invoice": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Invoice",
      "type": "object",
      "description": "Represents an invoice for a reservation.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the invoice."
        },
        "reservationId": {
          "type": "string",
          "description": "Reference to Reservation. (Relationship: Reservation 1:1 Invoice)"
        },
        "invoiceDate": {
          "type": "string",
          "description": "The date the invoice was issued.",
          "format": "date-time"
        },
        "dueDate": {
          "type": "string",
          "description": "The date the invoice is due.",
          "format": "date-time"
        },
        "amountDue": {
          "type": "number",
          "description": "The amount due on the invoice."
        },
        "amountPaid": {
          "type": "number",
          "description": "The amount paid on the invoice."
        },
        "paymentDate": {
          "type": "string",
          "description": "The date the invoice was paid.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "The status of the invoice (e.g., Paid, Unpaid, Overdue)."
        }
      },
      "required": [
        "id",
        "reservationId",
        "invoiceDate",
        "dueDate",
        "amountDue",
        "amountPaid",
        "status"
      ]
    },
    "Staff": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Staff",
      "type": "object",
      "description": "Represents a staff member of the hotel.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the staff member."
        },
        "firstName": {
          "type": "string",
          "description": "The first name of the staff member."
        },
        "lastName": {
          "type": "string",
          "description": "The last name of the staff member."
        },
        "email": {
          "type": "string",
          "description": "The email address of the staff member.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "The phone number of the staff member."
        },
        "role": {
          "type": "string",
          "description": "The role of the staff member (e.g., Manager, Receptionist)."
        },
        "permissions": {
          "type": "array",
          "description": "A list of permissions assigned to the staff member.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "phoneNumber",
        "role"
      ]
    },
    "OccupancyForecast": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "OccupancyForecast",
      "type": "object",
      "description": "Represents an occupancy forecast based on AI predictions.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the occupancy forecast."
        },
        "forecastDate": {
          "type": "string",
          "description": "The date for which the occupancy is being forecast.",
          "format": "date-time"
        },
        "predictedOccupancyRate": {
          "type": "number",
          "description": "The predicted occupancy rate for the forecast date."
        },
        "historicalDataUsed": {
          "type": "string",
          "description": "Reference to the historical booking and occupancy data for the forecast."
        },
        "notes": {
          "type": "string",
          "description": "Any notes or additional information regarding the forecast."
        }
      },
      "required": [
        "id",
        "forecastDate",
        "predictedOccupancyRate"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/clients/{clientId}",
        "definition": {
          "entityName": "Client",
          "schema": {
            "$ref": "#/backend/entities/Client"
          },
          "description": "Stores client data with path-based ownership for user privacy.",
          "params": [
            {
              "name": "userId",
              "description": "The ID of the user who owns this client data."
            },
            {
              "name": "clientId",
              "description": "The unique ID of the client."
            }
          ]
        }
      },
      {
        "path": "/rooms/{roomId}",
        "definition": {
          "entityName": "Room",
          "schema": {
            "$ref": "#/backend/entities/Room"
          },
          "description": "Stores room data.",
          "params": [
            {
              "name": "roomId",
              "description": "The unique ID of the room."
            }
          ]
        }
      },
      {
        "path": "/reservations/{reservationId}",
        "definition": {
          "entityName": "Reservation",
          "schema": {
            "$ref": "#/backend/entities/Reservation"
          },
          "description": "Stores reservation data, including clientId and roomId for easy querying.",
          "params": [
            {
              "name": "reservationId",
              "description": "The unique ID of the reservation."
            }
          ]
        }
      },
      {
        "path": "/invoices/{invoiceId}",
        "definition": {
          "entityName": "Invoice",
          "schema": {
            "$ref": "#/backend/entities/Invoice"
          },
          "description": "Stores invoice data, including reservationId for traceability.",
          "params": [
            {
              "name": "invoiceId",
              "description": "The unique ID of the invoice."
            }
          ]
        }
      },
      {
        "path": "/staff/{staffId}",
        "definition": {
          "entityName": "Staff",
          "schema": {
            "$ref": "#/backend/entities/Staff"
          },
          "description": "Stores staff data, including role information.",
          "params": [
            {
              "name": "staffId",
              "description": "The unique ID of the staff member."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{staffId}",
        "definition": {
          "entityName": "Staff",
          "schema": {
            "$ref": "#/backend/entities/Staff"
          },
          "description": "Admin role assignment based on document existence.  StaffId here is the same as the Firebase Auth UID.  Authorization relies solely on `request.auth.uid`.",
          "params": [
            {
              "name": "staffId",
              "description": "The UID of the staff member (from Firebase Auth)."
            }
          ]
        }
      },
      {
        "path": "/occupancyForecasts/{forecastId}",
        "definition": {
          "entityName": "OccupancyForecast",
          "schema": {
            "$ref": "#/backend/entities/OccupancyForecast"
          },
          "description": "Stores occupancy forecast data.",
          "params": [
            {
              "name": "forecastId",
              "description": "The unique ID of the occupancy forecast."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to manage hotel operations, including room, client, reservation, invoice, and staff data. It prioritizes Authorization Independence by storing all necessary authorization data within the relevant documents, eliminating the need for `get()` calls in security rules. It also provides separation of concerns for QAPS. Private data resides in path-based ownership collections. Collaborative or role-based data are in segregated collections.\n\nClients' private data is stored under `/users/{userId}/clients/{clientId}` to take advantage of path-based security rules.\n\nRooms are stored in a top-level `/rooms/{roomId}` collection. This allows all staff to easily list all rooms without requiring complex rule structures.\n\nReservations are stored under `/reservations/{reservationId}`, including the `clientId` and `roomId` to simplify queries and management. Invoices are stored under `/invoices/{invoiceId}`, and they include the `reservationId` for traceability.\n\nStaff data is stored under `/staff/{staffId}` and includes a `role` field.  A separate `/roles_admin/{staffId}` collection is used to denote admin status based on the staff member's `uid` existence.  This existence-based check provides a simple and efficient way to manage admin privileges.\n\nOccupancy Forecasts are stored in the `/occupancyForecasts/{forecastId}` collection for reporting and analytical purposes."
  }
}